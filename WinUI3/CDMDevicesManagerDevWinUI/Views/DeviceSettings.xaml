<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="CDMDevicesManagerDevWinUI.Views.DeviceSettings"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:CDMDevicesManagerDevWinUI.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:toolkit="using:CommunityToolkit.WinUI.Controls"
    xmlns:dev="using:DevWinUI"
    mc:Ignorable="d">

    <Grid>
        <ScrollViewer VerticalScrollBarVisibility="Auto" 
                      HorizontalScrollBarVisibility="Disabled"
                      HorizontalAlignment="Center"
                      Padding="32">
            <StackPanel MaxWidth="800" 
                        Spacing="6" 
                        HorizontalAlignment="Stretch"
                        Width="800">

                <!-- Page Title -->
                <TextBlock Text="Device Settings" 
                           FontSize="28" 
                           FontWeight="Bold" 
                           Margin="0,0,0,24" />

                <!-- Device Information Section -->
                <toolkit:SettingsExpander Description="View detailed information about your device" 
                                          Header="Device Information"
                                          IsExpanded="True"
                                          HorizontalAlignment="Stretch"
                                          HorizontalContentAlignment="Stretch">
                    <toolkit:SettingsExpander.HeaderIcon>
                        <FontIcon Glyph="&#xE7F4;" />
                    </toolkit:SettingsExpander.HeaderIcon>
                    <toolkit:SettingsExpander.Items>
                        <toolkit:SettingsCard Header="Product" 
                                              Description="Device product name"
                                              HorizontalContentAlignment="Stretch">
                            <TextBlock x:Name="ProductNameText" 
                                       Text="Unknown Product" 
                                       HorizontalAlignment="Right"
                                       TextWrapping="Wrap" />
                        </toolkit:SettingsCard>
                        <toolkit:SettingsCard Header="Serial Number" 
                                              Description="Device serial identifier"
                                              HorizontalContentAlignment="Stretch">
                            <TextBlock x:Name="SerialNumberText" 
                                       Text="Unknown Serial" 
                                       HorizontalAlignment="Right"
                                       TextWrapping="Wrap" />
                        </toolkit:SettingsCard>
                        <toolkit:SettingsCard Header="Manufacturer" 
                                              Description="Device manufacturer"
                                              HorizontalContentAlignment="Stretch">
                            <TextBlock x:Name="ManufacturerText" 
                                       Text="Unknown Manufacturer" 
                                       HorizontalAlignment="Right"
                                       TextWrapping="Wrap" />
                        </toolkit:SettingsCard>
                        <toolkit:SettingsCard Header="Hardware Version" 
                                              Description="Device hardware revision"
                                              HorizontalContentAlignment="Stretch">
                            <TextBlock x:Name="HardwareVersionText" 
                                       Text="Loading..." 
                                       HorizontalAlignment="Right"
                                       TextWrapping="Wrap" />
                        </toolkit:SettingsCard>
                        <toolkit:SettingsCard Header="Firmware Version" 
                                              Description="Device firmware version"
                                              HorizontalContentAlignment="Stretch">
                            <TextBlock x:Name="FirmwareVersionText" 
                                       Text="Loading..." 
                                       HorizontalAlignment="Right"
                                       TextWrapping="Wrap" />
                        </toolkit:SettingsCard>
                    </toolkit:SettingsExpander.Items>
                </toolkit:SettingsExpander>

                <!-- Firmware Update Section -->
                <toolkit:SettingsExpander Description="Check and install firmware updates" 
                                          Header="Firmware Update"
                                          HorizontalAlignment="Stretch"
                                          HorizontalContentAlignment="Stretch">
                    <toolkit:SettingsExpander.HeaderIcon>
                        <FontIcon Glyph="&#xE895;" />
                    </toolkit:SettingsExpander.HeaderIcon>
                    <toolkit:SettingsExpander.Items>
                        <toolkit:SettingsCard Header="Update Status" 
                                              Description="Current firmware update status"
                                              HorizontalContentAlignment="Stretch">
                            <StackPanel Orientation="Horizontal" 
                                        Spacing="8" 
                                        HorizontalAlignment="Right">
                                <Ellipse x:Name="UpdateStatusIndicator" 
                                         Width="12" Height="12" 
                                         Fill="Gray" />
                                <TextBlock x:Name="UpdateStatusText" 
                                           Text="Not checked" 
                                           VerticalAlignment="Center" />
                            </StackPanel>
                        </toolkit:SettingsCard>
                        <toolkit:SettingsCard Header="Check for Updates" 
                                              Description="Check if new firmware is available"
                                              HorizontalContentAlignment="Stretch">
                            <Button x:Name="CheckUpdateButton" 
                                    Content="Check for Updates" 
                                    Click="CheckUpdateButton_Click" 
                                    MinWidth="120"
                                    HorizontalAlignment="Right" />
                        </toolkit:SettingsCard>
                        <toolkit:SettingsCard Header="Install Update" 
                                              Description="Install available firmware update"
                                              HorizontalContentAlignment="Stretch">
                            <Button x:Name="InstallUpdateButton" 
                                    Content="Install Update" 
                                    Click="InstallUpdateButton_Click"
                                    IsEnabled="False" 
                                    MinWidth="120"
                                    HorizontalAlignment="Right" />
                        </toolkit:SettingsCard>
                    </toolkit:SettingsExpander.Items>
                </toolkit:SettingsExpander>

                <!-- Device Operations Section -->
                <toolkit:SettingsExpander Description="Perform device operations and maintenance" 
                                          Header="Device Operations"
                                          HorizontalAlignment="Stretch"
                                          HorizontalContentAlignment="Stretch">
                    <toolkit:SettingsExpander.HeaderIcon>
                        <FontIcon Glyph="&#xE713;" />
                    </toolkit:SettingsExpander.HeaderIcon>
                    <toolkit:SettingsExpander.Items>
                        <toolkit:SettingsCard Header="Display Brightness" 
                                              Description="Adjust the display brightness level"
                                              HorizontalContentAlignment="Stretch">
                            <Grid MinWidth="200" HorizontalAlignment="Right">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Slider x:Name="BrightnessSlider"
                                        Grid.Column="0"
                                        Minimum="0" 
                                        Maximum="100" 
                                        Value="80"
                                        ValueChanged="BrightnessSlider_ValueChanged"
                                        Width="150"
                                        Margin="0,0,12,0" />
                                <TextBlock x:Name="BrightnessValueText"
                                           Grid.Column="1"
                                           Text="80" 
                                           VerticalAlignment="Center" 
                                           MinWidth="30"
                                           HorizontalAlignment="Center" />
                            </Grid>
                        </toolkit:SettingsCard>
                        <toolkit:SettingsCard Header="Display Rotation" 
                                              Description="Set the display orientation"
                                              HorizontalContentAlignment="Stretch">
                            <StackPanel Orientation="Horizontal" 
                                        Spacing="8"
                                        HorizontalAlignment="Right">
                                <RadioButton x:Name="Rotation0" Content="0°" GroupName="Rotation" IsChecked="True" Checked="RotationChanged" />
                                <RadioButton x:Name="Rotation90" Content="90°" GroupName="Rotation" Checked="RotationChanged" />
                                <RadioButton x:Name="Rotation180" Content="180°" GroupName="Rotation" Checked="RotationChanged" />
                                <RadioButton x:Name="Rotation270" Content="270°" GroupName="Rotation" Checked="RotationChanged" />
                            </StackPanel>
                        </toolkit:SettingsCard>
                        <toolkit:SettingsCard Header="Restart Device" 
                                              Description="Restart the device to apply changes"
                                              HorizontalContentAlignment="Stretch">
                            <Button x:Name="RestartDeviceButton" 
                                    Content="Restart Device" 
                                    Click="RestartDeviceButton_Click" 
                                    MinWidth="120"
                                    HorizontalAlignment="Right" />
                        </toolkit:SettingsCard>
                        <toolkit:SettingsCard Header="Factory Reset" 
                                              Description="Reset device to factory settings"
                                              HorizontalContentAlignment="Stretch">
                            <Button x:Name="FactoryResetButton" 
                                    Content="Factory Reset" 
                                    Click="FactoryResetButton_Click" 
                                    MinWidth="120"
                                    HorizontalAlignment="Right" />
                        </toolkit:SettingsCard>
                        <toolkit:SettingsCard Header="Refresh Information" 
                                              Description="Update device information display"
                                              HorizontalContentAlignment="Stretch">
                            <Button x:Name="RefreshInfoButton" 
                                    Content="Refresh Information" 
                                    Click="RefreshInfoButton_Click" 
                                    MinWidth="120"
                                    HorizontalAlignment="Right" />
                        </toolkit:SettingsCard>
                        <toolkit:SettingsCard Header="Device Status" 
                                              Description="Get detailed device status"
                                              HorizontalContentAlignment="Stretch">
                            <Button x:Name="DeviceStatusButton" 
                                    Content="Get Device Status" 
                                    Click="DeviceStatusButton_Click" 
                                    MinWidth="120"
                                    HorizontalAlignment="Right" />
                        </toolkit:SettingsCard>
                    </toolkit:SettingsExpander.Items>
                </toolkit:SettingsExpander>

                <!-- Device Configuration Section -->
                <toolkit:SettingsExpander Description="Configure device settings and preferences" 
                                          Header="Device Configuration"
                                          HorizontalAlignment="Stretch"
                                          HorizontalContentAlignment="Stretch">
                    <toolkit:SettingsExpander.HeaderIcon>
                        <FontIcon Glyph="&#xE115;" />
                    </toolkit:SettingsExpander.HeaderIcon>
                    <toolkit:SettingsExpander.Items>
                        <toolkit:SettingsCard Header="Sleep Mode" 
                                              Description="Configure the display when system enter sleep mode"
                                              HorizontalContentAlignment="Stretch">
                            <ToggleSwitch x:Name="SleepModeToggle"
                                          Toggled="SleepModeToggle_Toggled"
                                          HorizontalAlignment="Right" 
                                          ToolTipService.ToolTip="ON: LCD off when system in sleep state. OFF: LCD on when system in sleep state."/>
                        </toolkit:SettingsCard>

                        <toolkit:SettingsCard Header="Offline Mode" 
                                              Description="Setting customized style when this application exit."
                                              HorizontalContentAlignment="Stretch">
                            <ToggleSwitch x:Name="OfflineModeToggle"
                                          Toggled="OfflineModeToggle_Toggled"
                                          HorizontalAlignment="Right" 
                                          ToolTipService.ToolTip="OFF: Play the device build-in animation.  ON: Play the below imported image or animation."/>
                        </toolkit:SettingsCard>

                        <!-- Suspend Media Display Panel (shown when Offline Mode is enabled) -->
                        <toolkit:SettingsCard x:Name="SuspendMediaCard"
                                              Header="Active Suspend Media" 
                                              Description="Images and videos that will be displayed in offline mode"
                                              HorizontalContentAlignment="Stretch"
                                              Visibility="Collapsed">
                            <toolkit:SettingsCard.Content>
                                <ScrollViewer MaxHeight="300" 
                                      VerticalScrollBarVisibility="Auto"
                                      HorizontalScrollBarVisibility="Disabled">
                                    <ItemsRepeater x:Name="SuspendMediaSlotsRepeater">
                                        <ItemsRepeater.Layout>
                                            <UniformGridLayout Orientation="Horizontal" 
                                                ItemsJustification="Start"
                                                ItemsStretch="None"
                                                MinColumnSpacing="8"
                                                MinRowSpacing="8"
                                                MaximumRowsOrColumns="3"/>
                                        </ItemsRepeater.Layout>
                                        <ItemsRepeater.ItemTemplate>
                                            <DataTemplate>
                                                <Border Width="120" 
                                                            Height="120" 
                                                            CornerRadius="8"
                                                            BorderBrush="Gray"
                                                            BorderThickness="1"
                                                            Background="LightGray">
                                                    <Grid>
                                                        <!-- Media Content Container -->
                                                        <StackPanel x:Name="MediaContentPanel" 
                                                                        Orientation="Vertical" 
                                                                        Spacing="4"
                                                                        Padding="8"
                                                                        Visibility="{Binding HasMedia, Converter={StaticResource BoolToVisibilityConverter}}">
                                                            <!-- Media Thumbnail/Icon -->
                                                            <Border Height="60" 
                                                                        CornerRadius="4"
                                                                        Background="White">
                                                                <Grid>
                                                                    <Image Source="{Binding LocalPath, Converter={StaticResource FilePathToImageSourceConverter}}"
                                                                               Stretch="UniformToFill"
                                                                               Visibility="{Binding IsImage, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                                                    <FontIcon Glyph="&#xE714;"
                                                                                  FontSize="24"
                                                                                  HorizontalAlignment="Center"
                                                                                  VerticalAlignment="Center"
                                                                                  Visibility="{Binding IsVideo, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                                                </Grid>
                                                            </Border>

                                                            <!-- File Name -->
                                                            <TextBlock Text="{Binding FileName}" 
                                                                           FontSize="10"
                                                                           TextAlignment="Center"
                                                                           TextWrapping="Wrap"
                                                                           MaxLines="2"/>

                                                            <!-- Remove Button -->
                                                            <Button Content="Remove"
                                                                        FontSize="10"
                                                                        Padding="4,2"
                                                                        HorizontalAlignment="Center"
                                                                        Click="RemoveMediaButton_Click"
                                                                        Tag="{Binding SlotIndex}"/>
                                                        </StackPanel>

                                                        <!-- Add Media Container -->
                                                        <StackPanel x:Name="AddMediaPanel"
                                                                        Orientation="Vertical"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Spacing="8"
                                                                        Visibility="{Binding HasMedia, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=True}">
                                                            <FontIcon Glyph="&#xE710;" 
                                                                          FontSize="32"
                                                                          Foreground="Gray"
                                                                          HorizontalAlignment="Center"/>
                                                            <TextBlock Text="Add Media" 
                                                                           FontSize="12"
                                                                           Foreground="Gray"
                                                                           HorizontalAlignment="Center"/>
                                                            <Button Content="+"
                                                                        FontSize="16"
                                                                        Width="32"
                                                                        Height="32"
                                                                        CornerRadius="16"
                                                                        HorizontalAlignment="Center"
                                                                        Click="AddMediaToSlotButton_Click"
                                                                        Tag="{Binding SlotIndex}"/>
                                                        </StackPanel>

                                                        <!-- Slot Number Badge -->
                                                        <Border Background="DodgerBlue"
                                                                    CornerRadius="12"
                                                                    Width="24"
                                                                    Height="24"
                                                                    HorizontalAlignment="Right"
                                                                    VerticalAlignment="Top"
                                                                    Margin="4">
                                                            <TextBlock Text="{Binding SlotNumber}"
                                                                           FontSize="10"
                                                                           FontWeight="Bold"
                                                                           Foreground="White"
                                                                           HorizontalAlignment="Center"
                                                                           VerticalAlignment="Center"/>
                                                        </Border>
                                                    </Grid>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsRepeater.ItemTemplate>
                                    </ItemsRepeater>
                                </ScrollViewer>
                            </toolkit:SettingsCard.Content>
                        </toolkit:SettingsCard>
                    </toolkit:SettingsExpander.Items>
                </toolkit:SettingsExpander>

                <!-- Status Information Section -->
                <toolkit:SettingsExpander Description="View detailed device status information" 
                                          Header="Status Information"
                                          HorizontalAlignment="Stretch"
                                          HorizontalContentAlignment="Stretch">
                    <toolkit:SettingsExpander.HeaderIcon>
                        <FontIcon Glyph="&#xE946;" />
                    </toolkit:SettingsExpander.HeaderIcon>
                    <toolkit:SettingsExpander.Items>
                        <!-- Display Settings Status -->
                        <toolkit:SettingsCard Header="Brightness Level" 
                                              Description="Current display brightness setting"
                                              HorizontalContentAlignment="Stretch">
                            <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Right">
                                <ProgressBar x:Name="StatusBrightnessProgressBar"
                                             Width="80"
                                             Height="6"
                                             Minimum="0"
                                             Maximum="100"
                                             Value="0"
                                             VerticalAlignment="Center" />
                                <TextBlock x:Name="StatusBrightnessText" 
                                           Text="--%" 
                                           VerticalAlignment="Center"
                                           MinWidth="35" />
                            </StackPanel>
                        </toolkit:SettingsCard>
                        
                        <toolkit:SettingsCard Header="Screen Rotation" 
                                              Description="Current display orientation"
                                              HorizontalContentAlignment="Stretch">
                            <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Right">
                                <FontIcon x:Name="StatusRotationIcon" 
                                          Glyph="&#xE7AD;" 
                                          FontSize="16" />
                                <TextBlock x:Name="StatusRotationText" 
                                           Text="--°" 
                                           VerticalAlignment="Center" />
                            </StackPanel>
                        </toolkit:SettingsCard>
                        
                        <toolkit:SettingsCard Header="Sleep Mode" 
                                              Description="Display sleep state"
                                              HorizontalContentAlignment="Stretch">
                            <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Right">
                                <Ellipse x:Name="StatusSleepIndicator" 
                                         Width="12" Height="12" 
                                         Fill="Gray" />
                                <TextBlock x:Name="StatusSleepText" 
                                           Text="Unknown" 
                                           VerticalAlignment="Center" />
                            </StackPanel>
                        </toolkit:SettingsCard>
                        
                        <toolkit:SettingsCard Header="OSD State" 
                                              Description="On-Screen Display status"
                                              HorizontalContentAlignment="Stretch">
                            <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Right">
                                <Ellipse x:Name="StatusOsdIndicator" 
                                         Width="12" Height="12" 
                                         Fill="Gray" />
                                <TextBlock x:Name="StatusOsdText" 
                                           Text="Unknown" 
                                           VerticalAlignment="Center" />
                            </StackPanel>
                        </toolkit:SettingsCard>
                        
                        <toolkit:SettingsCard Header="Keep Alive Timeout" 
                                              Description="Connection timeout setting"
                                              HorizontalContentAlignment="Stretch">
                            <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Right">
                                <FontIcon Glyph="&#xE916;" FontSize="16" />
                                <TextBlock x:Name="StatusKeepAliveText" 
                                           Text="--s" 
                                           VerticalAlignment="Center" />
                            </StackPanel>
                        </toolkit:SettingsCard>
                        
                        <toolkit:SettingsCard Header="Suspend Media Status" 
                                              Description="Media slots and usage"
                                              HorizontalContentAlignment="Stretch">
                            <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Right">
                                <ProgressBar x:Name="StatusMediaProgressBar"
                                             Width="80"
                                             Height="6"
                                             Minimum="0"
                                             Maximum="5"
                                             Value="0"
                                             VerticalAlignment="Center" />
                                <TextBlock x:Name="StatusMediaText" 
                                           Text="0/0" 
                                           VerticalAlignment="Center"
                                           MinWidth="30" />
                            </StackPanel>
                        </toolkit:SettingsCard>
                        
                        <toolkit:SettingsCard Header="Media Slots Detail" 
                                              Description="Individual media slot status"
                                              HorizontalContentAlignment="Stretch">
                            <toolkit:SettingsCard.Content>
                                <StackPanel x:Name="MediaSlotsPanel" 
                                            Orientation="Horizontal" 
                                            Spacing="8"
                                            HorizontalAlignment="Right"
                                            Margin="0,8,0,0">
                                    <!-- Media slot indicators will be added dynamically -->
                                </StackPanel>
                            </toolkit:SettingsCard.Content>
                        </toolkit:SettingsCard>
                        
                        <toolkit:SettingsCard Header="Last Updated" 
                                              Description="Status information timestamp"
                                              HorizontalContentAlignment="Stretch">
                            <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Right">
                                <FontIcon Glyph="&#xE823;" FontSize="16" />
                                <TextBlock x:Name="StatusTimestampText" 
                                           Text="Never" 
                                           VerticalAlignment="Center" />
                            </StackPanel>
                        </toolkit:SettingsCard>
                    </toolkit:SettingsExpander.Items>
                </toolkit:SettingsExpander>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>
