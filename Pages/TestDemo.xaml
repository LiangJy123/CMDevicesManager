<Page x:Class="CMDevicesManager.Pages.TestDemo"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:CMDevicesManager.Pages"
      mc:Ignorable="d" 
      d:DesignHeight="800" d:DesignWidth="1200"
      Title="Win2D Render Service Demo">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Grid.Row="0" Background="#2E3440" Padding="20" CornerRadius="8" Margin="0,0,0,20">
            <StackPanel>
                <TextBlock Text="SkiaSharp Render Service Demo" 
                          FontSize="24" FontWeight="Bold" 
                          Foreground="White" HorizontalAlignment="Center"/>
                <TextBlock Text="Real-time 2D rendering with live system metrics" 
                          FontSize="14" Foreground="#D8DEE9" 
                          HorizontalAlignment="Center" Margin="0,5,0,0"/>
            </StackPanel>
        </Border>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel - Controls -->
            <Border Grid.Column="0" Background="#3B4252" CornerRadius="8" Padding="15" Margin="0,0,10,0">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="Render Controls" FontSize="18" FontWeight="Bold" 
                                  Foreground="White" Margin="0,0,0,15"/>

                        <!-- Service Status -->
                        <GroupBox Header="Service Status" Foreground="White" Margin="0,0,0,15">
                            <StackPanel>
                                <TextBlock Text="{Binding ServiceStatus}" FontSize="12" Foreground="#A3BE8C"/>
                                <TextBlock Text="{Binding RenderingStatus}" FontSize="12" Foreground="#EBCB8B"/>
                                <TextBlock Text="{Binding ElementCount}" FontSize="12" Foreground="#81A1C1"/>
                            </StackPanel>
                        </GroupBox>

                        <!-- Basic Controls -->
                        <GroupBox Header="Basic Operations" Foreground="White" Margin="0,0,0,15">
                            <StackPanel>
                                <Button x:Name="InitializeBtn" Content="Initialize Service" 
                                       Click="InitializeBtn_Click" Margin="0,5"/>
                                <Button x:Name="StartRenderBtn" Content="Start Real-time (30 FPS)" 
                                       Click="StartRenderBtn_Click" Margin="0,5"/>
                                <Button x:Name="StopRenderBtn" Content="Stop Real-time" 
                                       Click="StopRenderBtn_Click" Margin="0,5"/>
                                <Button x:Name="RenderOnceBtn" Content="Render Single Frame" 
                                       Click="RenderOnceBtn_Click" Margin="0,5"/>
                            </StackPanel>
                        </GroupBox>

                        <!-- Element Controls -->
                        <GroupBox Header="Add Elements" Foreground="White" Margin="0,0,0,15">
                            <StackPanel>
                                <Button x:Name="AddCpuBtn" Content="Add Live CPU Usage" 
                                       Click="AddCpuBtn_Click" Margin="0,5"/>
                                <Button x:Name="AddGpuBtn" Content="Add Live GPU Usage" 
                                       Click="AddGpuBtn_Click" Margin="0,5"/>
                                <Button x:Name="AddDateTimeBtn" Content="Add Live Date/Time" 
                                       Click="AddDateTimeBtn_Click" Margin="0,5"/>
                                <Button x:Name="AddTextBtn" Content="Add Custom Text" 
                                       Click="AddTextBtn_Click" Margin="0,5"/>
                                <Button x:Name="AddImageBtn" Content="Add Background Image" 
                                       Click="AddImageBtn_Click" Margin="0,5"/>
                            </StackPanel>
                        </GroupBox>

                        <!-- Canvas Settings -->
                        <GroupBox Header="Canvas Settings" Foreground="White" Margin="0,0,0,15">
                            <StackPanel>
                                <TextBlock Text="Canvas Size:" Foreground="White" Margin="0,5,0,2"/>
                                <ComboBox x:Name="CanvasSizeCombo" SelectedIndex="1" Margin="0,0,0,10">
                                    <ComboBoxItem Content="256x256"/>
                                    <ComboBoxItem Content="512x512"/>
                                    <ComboBoxItem Content="1024x1024"/>
                                </ComboBox>
                                
                                <TextBlock Text="Background Color:" Foreground="White" Margin="0,5,0,2"/>
                                <StackPanel Orientation="Horizontal">
                                    <Button x:Name="BgBlackBtn" Content="Black" Click="BgColor_Click" Tag="Black" Width="60" Margin="2"/>
                                    <Button x:Name="BgBlueBtn" Content="Blue" Click="BgColor_Click" Tag="Blue" Width="60" Margin="2"/>
                                    <Button x:Name="BgWhiteBtn" Content="White" Click="BgColor_Click" Tag="White" Width="60" Margin="2"/>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>

                        <!-- Export -->
                        <GroupBox Header="Export" Foreground="White">
                            <StackPanel>
                                <Button x:Name="ExportPngBtn" Content="Export to PNG" 
                                       Click="ExportPngBtn_Click" Margin="0,5"/>
                                <Button x:Name="SaveFramesBtn" Content="Save Debug Frames" 
                                       Click="SaveFramesBtn_Click" Margin="0,5"/>
                                <TextBlock x:Name="ExportStatusTxt" Text="Ready to export" 
                                          FontSize="10" Foreground="#A3BE8C" Margin="0,5,0,0"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </Border>

            <!-- Center Panel - Live Preview -->
            <Border Grid.Column="1" Background="#2E3440" CornerRadius="8" Padding="20" Margin="5,0,5,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="Live Preview" FontSize="16" FontWeight="Bold" 
                              Foreground="White" HorizontalAlignment="Center" Margin="0,0,0,15"/>

                    <Border Grid.Row="1" Background="#4C566A" CornerRadius="4">
                        <Viewbox Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Image x:Name="PreviewImage" Width="512" Height="512" 
                                  Stretch="Uniform" RenderOptions.BitmapScalingMode="NearestNeighbor"/>
                        </Viewbox>
                    </Border>

                    <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,15,0,0">
                        <TextBlock Text="FPS: " Foreground="White" VerticalAlignment="Center"/>
                        <TextBlock x:Name="FpsTxt" Text="0" Foreground="#A3BE8C" VerticalAlignment="Center" Margin="5,0,15,0"/>
                        <TextBlock Text="Frame: " Foreground="White" VerticalAlignment="Center"/>
                        <TextBlock x:Name="FrameCountTxt" Text="0" Foreground="#EBCB8B" VerticalAlignment="Center"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Right Panel - System Info & Logs -->
            <Border Grid.Column="2" Background="#3B4252" CornerRadius="8" Padding="15" Margin="10,0,0,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="200"/>
                    </Grid.RowDefinitions>

                    <!-- System Metrics -->
                    <GroupBox Grid.Row="0" Header="Live System Metrics" Foreground="White" Margin="0,0,0,15">
                        <StackPanel>
                            <TextBlock Text="{Binding CpuUsage}" FontSize="14" Foreground="#A3BE8C" Margin="0,2"/>
                            <TextBlock Text="{Binding GpuUsage}" FontSize="14" Foreground="#EBCB8B" Margin="0,2"/>
                            <TextBlock Text="{Binding MemoryUsage}" FontSize="14" Foreground="#81A1C1" Margin="0,2"/>
                            <TextBlock Text="{Binding CurrentTime}" FontSize="12" Foreground="#D8DEE9" Margin="0,5,0,0"/>
                        </StackPanel>
                    </GroupBox>

                    <!-- Elements List -->
                    <GroupBox Grid.Row="1" Header="Render Elements" Foreground="White" Margin="0,0,0,15">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <ListBox x:Name="ElementsList" Background="Transparent" 
                                    BorderThickness="0" Foreground="White">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding Id}" Width="80" FontSize="10"/>
                                            <TextBlock Text="{Binding Type}" Width="60" FontSize="10" Foreground="#EBCB8B"/>
                                            <Button Content="×" Width="20" Height="20" FontSize="10" 
                                                   Click="RemoveElement_Click" Tag="{Binding Id}"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </ScrollViewer>
                    </GroupBox>

                    <!-- Log Output -->
                    <GroupBox Grid.Row="2" Header="Log Output" Foreground="White">
                        <ScrollViewer x:Name="LogScrollViewer" VerticalScrollBarVisibility="Auto">
                            <TextBlock x:Name="LogOutput" FontSize="10" FontFamily="Consolas" 
                                      Foreground="#D8DEE9" TextWrapping="Wrap"/>
                        </ScrollViewer>
                    </GroupBox>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Page>
